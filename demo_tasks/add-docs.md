Add comprehensive docstrings to all functions